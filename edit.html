<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–¥–∞–∫—Ç–æ—Ä Wordsearch by Nika Shum</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&family=Comic+Neue&family=Orbitron&family=Baloo+2&family=Comfortaa&family=Michroma&family=Fredoka&family=M+PLUS+Rounded+1c&family=Ruslan+Display&family=ZCOOL+KuaiLe&family=Ma+Shan+Zheng&family=Noto+Sans+JP&family=Noto+Sans+SC&family=Yomogi&display=swap" rel="stylesheet">
  <style>
    body {
      background: #0a0a0a;
      color: white;
      font-family: 'Comfortaa', sans-serif;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-size: 2rem;
      color: #00ffff;
      margin-bottom: 1rem;
    }
    .form-group {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      width: 100%;
      max-width: 720px;
      margin-bottom: 1rem;
    }
    .form-group label {
      margin-bottom: 0.5rem;
      font-weight: bold;
      font-size: 1rem;
    }
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 0.6rem;
      border-radius: 12px;
      border: none;
      font-size: 1rem;
      background: #111;
      color: white;
    }
    .color-options {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .color-square {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid white;
    }
    .preview-title {
      margin-top: 2rem;
      font-size: 1.2rem;
      color: #00ffff;
    }
    #previewContainer {
      width: 100%;
      height: 480px;
      margin-top: 1rem;
      border: 2px solid #00ffff;
      border-radius: 12px;
      overflow: hidden;
    }
    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    textarea {
      width: 100%;
      height: 200px;
      font-family: monospace;
      margin-top: 1rem;
      border-radius: 12px;
      padding: 1rem;
      background: #111;
      color: white;
      border: 2px solid #00ffff;
    }
    button {
      background: #00ffff;
      color: black;
      font-weight: bold;
      border: none;
      border-radius: 12px;
      padding: 0.7rem 1.5rem;
      margin-top: 1rem;
      cursor: pointer;
      font-size: 1rem;
    }
    .hint {
      font-size: 0.9rem;
      opacity: 0.7;
      margin-top: -0.5rem;
    }
    .warning {
      color: #ff5555;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <h1>üß© Wordsearch Editor by Nika Shum</h1>

  <div class="form-group">
    <label for="words">–°–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
    <input type="text" id="words" value="–ö–û–¢, –î–û–ì, –õ–ï–°, –î–û–ú">
    <div class="hint" id="langHint">–Ø–∑—ã–∫ –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</div>
    <div class="warning" id="langWarning" style="display:none;">–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —è–∑—ã–∫—É!</div>
  </div>

  <div class="form-group">
    <label for="gridSize">–†–∞–∑–º–µ—Ä –≥—Ä–∏–¥–∞ (6‚Äì12):</label>
    <input type="number" id="gridSize" min="6" max="12" value="10">
  </div>
  <div class="form-group">
    <label>–¶–≤–µ—Ç —Ñ–æ–Ω–∞ —è—á–µ–µ–∫:</label>
    <div class="color-options" id="cellColorOptions">
      <div class="color-square" style="background:#00ffff" data-color="#00ffff"></div>
      <div class="color-square" style="background:#ff00ff" data-color="#ff00ff"></div>
      <div class="color-square" style="background:#ffaa00" data-color="#ffaa00"></div>
      <div class="color-square" style="background:#00ff88" data-color="#00ff88"></div>
    </div>
    <input type="hidden" id="cellColor" value="#00ffff">
  </div>

  <div class="form-group">
    <label>–¶–≤–µ—Ç —Ä–∞–º–∫–∏:</label>
    <div class="color-options" id="borderColorOptions">
      <div class="color-square" style="background:#00ffff" data-color="#00ffff"></div>
      <div class="color-square" style="background:#ff0000" data-color="#ff0000"></div>
      <div class="color-square" style="background:#ffffff" data-color="#ffffff"></div>
      <div class="color-square" style="background:#ffaa00" data-color="#ffaa00"></div>
    </div>
    <input type="hidden" id="borderColor" value="#00ffff">
  </div>

  <div class="form-group">
    <label>–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞:</label>
    <div class="color-options" id="textColorOptions">
      <div class="color-square" style="background:#00ffff" data-color="#00ffff"></div>
      <div class="color-square" style="background:#ffffff" data-color="#ffffff"></div>
      <div class="color-square" style="background:#ff00ff" data-color="#ff00ff"></div>
      <div class="color-square" style="background:#00ff88" data-color="#00ff88"></div>
    </div>
    <input type="hidden" id="textColor" value="#00ffff">
  </div>

  <div class="form-group">
    <label>–¶–≤–µ—Ç —Å–≤–µ—á–µ–Ω–∏—è (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ):</label>
    <div class="color-options" id="glowColorOptions">
      <div class="color-square" style="background:#00ffff" data-color="#00ffff"></div>
      <div class="color-square" style="background:#ff00ff" data-color="#ff00ff"></div>
      <div class="color-square" style="background:#ffaa00" data-color="#ffaa00"></div>
      <div class="color-square" style="background:#00ff88" data-color="#00ff88"></div>
    </div>
    <input type="hidden" id="glowColor" value="#00ffff">
  </div>

  <div class="form-group">
    <label>–®—Ä–∏—Ñ—Ç:</label>
    <select id="font">
      <option value="Roboto">Roboto</option>
      <option value="Comic Neue">Comic Neue</option>
      <option value="Orbitron" selected>Orbitron</option>
      <option value="Baloo 2">Baloo 2</option>
      <option value="Comfortaa">Comfortaa</option>
      <option value="Michroma">Michroma</option>
      <option value="Fredoka">Fredoka</option>
      <option value="M PLUS Rounded 1c">M PLUS Rounded 1c</option>
      <option value="Ruslan Display">Ruslan Display</option>
      <option value="ZCOOL KuaiLe">ZCOOL KuaiLe</option>
      <option value="Yomogi">Yomogi</option>
      <option value="Noto Sans JP">Noto Sans JP</option>
      <option value="Noto Sans SC">Noto Sans SC</option>
    </select>
  </div>

  <div class="form-group">
    <label>–¢–µ–º–∞:</label>
    <select id="theme">
      <option value="default">–û–±—ã—á–Ω–∞—è</option>
      <option value="rainbow">–†–∞–¥—É–∂–Ω–∞—è (–ø–µ—Ä–µ–ª–∏–≤–∞—é—â–∏–µ—Å—è –±—É–∫–≤—ã)</option>
    </select>
  </div>

  <div class="form-group">
    <label>–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–ª–æ–≤:</label>
    <select id="wordlistPosition">
      <option value="wordlist-bottom">–°–Ω–∏–∑—É</option>
      <option value="wordlist-top">–°–≤–µ—Ä—Ö—É</option>
      <option value="wordlist-left">–°–ª–µ–≤–∞</option>
      <option value="wordlist-right">–°–ø—Ä–∞–≤–∞</option>
    </select>
  </div>

  <div class="form-group">
    <label for="winText">–§—Ä–∞–∑–∞ –ø–æ–±–µ–¥—ã:</label>
    <input type="text" id="winText" value="–¢—ã –Ω–∞—à—ë–ª –≤—Å–µ —Å–ª–æ–≤–∞!">
  </div>

  <div class="form-group">
    <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:</label>
    <label><input type="checkbox" id="glow" checked> –ù–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ</label>
    <label><input type="checkbox" id="sparkles"> –ë–ª—ë—Å—Ç–∫–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ</label>
  </div>

  <button onclick="generateCode()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å HTML</button>
<script>
  // –¶–≤–µ—Ç–æ–≤—ã–µ –∫—Ä—É–∂–∫–∏
  function setupColorPicker(groupId, hiddenInputId) {
    document.querySelectorAll(`#${groupId} .color-square`).forEach(square => {
      square.addEventListener('click', () => {
        document.querySelectorAll(`#${groupId} .color-square`).forEach(sq => {
          sq.classList.remove('selected');
        });
        square.classList.add('selected');
        document.getElementById(hiddenInputId).value = square.dataset.color;
      });
    });
    // –ê–≤—Ç–æ–≤—ã–±–æ—Ä –ø–µ—Ä–≤–æ–≥–æ
    document.querySelector(`#${groupId} .color-square`).classList.add('selected');
  }

  setupColorPicker("cellColorOptions", "cellColor");
  setupColorPicker("borderColorOptions", "borderColor");
  setupColorPicker("textColorOptions", "textColor");
  setupColorPicker("glowColorOptions", "glowColor");

  // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –ø–æ –ø–µ—Ä–≤—ã–º –±—É–∫–≤–∞–º —Å–ª–æ–≤
  function detectLanguage(words) {
    const text = words.join('').toLowerCase();
    if (/[\u3040-\u30ff\u31f0-\u31ff]/.test(text)) return 'ja'; // –Ø–ø–æ–Ω—Å–∫–∏–π
    if (/[\u4e00-\u9fff]/.test(text)) return 'zh'; // –ö–∏—Ç–∞–π—Å–∫–∏–π
    if (/[–∞-—è—ë]/i.test(text)) return 'ru'; // –†—É—Å—Å–∫–∏–π
    if (/[a-z]/i.test(text)) return 'en'; // –ê–Ω–≥–ª–∏–π—Å–∫–∏–π
    if (/[√©√†√®√π√ß√¥√¢√™√Æ√´√Ø√º]/i.test(text)) return 'fr'; // –§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π
    if (/[√§√∂√º√ü]/i.test(text)) return 'de'; // –ù–µ–º–µ—Ü–∫–∏–π
    if (/[√±√°√©√≠√≥√∫]/i.test(text)) return 'es'; // –ò—Å–ø–∞–Ω—Å–∫–∏–π
    return 'en';
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML
  async function generateCode() {
    const wordsInput = document.getElementById("words").value.trim();
    const words = wordsInput.split(",").map(w => w.trim().toUpperCase()).filter(w => w !== "");

    if (words.length === 0) {
      alert("–í–≤–µ–¥–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Å–ª–æ–≤–æ");
      return;
    }

    const size = document.getElementById("size").value;
    const winText = document.getElementById("winText").value;
    const font = document.getElementById("font").value;
    const theme = document.getElementById("theme").value;
    const glow = document.getElementById("glow").checked;
    const sparkles = document.getElementById("sparkles").checked;
    const position = document.getElementById("wordlistPosition").value;

    const cellColor = document.getElementById("cellColor").value;
    const borderColor = document.getElementById("borderColor").value;
    const textColor = document.getElementById("textColor").value;
    const glowColor = document.getElementById("glowColor").value;

    const lang = detectLanguage(words);

    // –®–∞–±–ª–æ–Ω –±—É–¥–µ—Ç –≤ —á–∞—Å—Ç–∏ 4
    const fullHTML = buildHTML({
      words,
      size,
      winText,
      font,
      theme,
      glow,
      sparkles,
      position,
      cellColor,
      borderColor,
      textColor,
      glowColor,
      lang
    });

    document.getElementById("result").value = fullHTML;

    const blob = new Blob([fullHTML], { type: "text/html" });
    document.getElementById("preview").src = URL.createObjectURL(blob);
  }
</script>
<script>
function buildHTML({
  words,
  size,
  winText,
  font,
  theme,
  glow,
  sparkles,
  position,
  cellColor,
  borderColor,
  textColor,
  glowColor,
  lang
}) {
  const fontLink = `https://fonts.googleapis.com/css2?family=${font.replace(/ /g, '+')}&display=swap`;
  const wordList = JSON.stringify(words);

  return `
<!DOCTYPE html>
<html lang="${lang}">
<head>
  <meta charset="UTF-8">
  <title>Wordsearch Game</title>
  <link href="${fontLink}" rel="stylesheet">
  <style>
    :root {
      --font-family: '${font}', sans-serif;
      --cell-bg: ${theme === "rainbow" ? "linear-gradient(45deg, red, orange, yellow, green, cyan, blue, violet)" : cellColor};
      --border-color: ${borderColor};
      --text-color: ${textColor};
      --glow-color: ${glowColor};
    }

    html, body {
      margin: 0;
      padding: 0;
      background: transparent;
      font-family: var(--font-family);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    #gameWrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    #grid {
      display: grid;
      gap: 4px;
    }

    .cell {
      width: 38px;
      height: 38px;
      background: var(--cell-bg);
      border: 2px solid var(--border-color);
      color: var(--text-color);
      font-weight: bold;
      font-size: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
      border-radius: 8px;
      ${glow ? "box-shadow: 0 0 6px var(--glow-color), inset 0 0 4px var(--glow-color);" : ""}
      transition: 0.2s;
    }

    .cell.selected {
      background: rgba(255,255,255,0.2);
      box-shadow: inset 0 0 8px var(--glow-color);
    }

    .cell.found {
      background: rgba(56, 255, 142, 0.3);
      color: #38ff8e;
    }

    .cell.rainbow {
      animation: rainbowGlow 2.5s linear infinite;
    }

    @keyframes rainbowGlow {
      0%   { box-shadow: 0 0 8px #ff0088; color: #ff0088; }
      25%  { box-shadow: 0 0 8px #00ffff; color: #00ffff; }
      50%  { box-shadow: 0 0 8px #00ff55; color: #00ff55; }
      75%  { box-shadow: 0 0 8px #ffaa00; color: #ffaa00; }
      100% { box-shadow: 0 0 8px #ff0088; color: #ff0088; }
    }

    #wordList {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      max-width: 90vw;
      font-size: 16px;
      justify-content: center;
    }

    #wordList span {
      padding: 6px 10px;
      border-radius: 8px;
      background: var(--cell-bg);
      color: var(--text-color);
      font-weight: bold;
      border: 1px solid var(--border-color);
    }

    #wordList span.found {
      text-decoration: line-through;
      background: rgba(0, 0, 0, 0.2);
      color: #38ff8e;
    }

    .wordlist-top { flex-direction: column-reverse; }
    .wordlist-bottom { flex-direction: column; }
    .wordlist-left { flex-direction: row-reverse; align-items: flex-start; }
    .wordlist-right { flex-direction: row; align-items: flex-start; }

    #winMessage {
      font-size: 20px;
      margin-top: 10px;
      color: var(--text-color);
      font-family: var(--font-family);
      display: none;
    }

    footer {
      margin-top: 1rem;
      font-size: 0.8rem;
      opacity: 0.6;
    }
  </style>
</head>
<body>
  <div id="gameWrapper" class="wordlist-${position}">
    <div id="grid"></div>
    <div id="wordList"></div>
    <div id="winMessage">${winText}</div>
    <footer>(C) –ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ë—É–¥—É—â–µ–≥–æ, 2025</footer>
  </div>
  <script>
    const words = ${wordList};
    const gridSize = ${size};
  </script>
`;
}
</script>
<script>
const directions = [
  [0,1], [1,0], [-1,0], [0,-1],
  [1,1], [-1,1], [-1,-1], [1,-1]
];

const grid = Array.from({length: gridSize}, () => Array(gridSize).fill(""));

function fits(word, x, y, dx, dy) {
  for (let i = 0; i < word.length; i++) {
    const nx = x + dx * i, ny = y + dy * i;
    if (nx < 0 || ny < 0 || nx >= gridSize || ny >= gridSize) return false;
    if (grid[ny][nx] !== "" && grid[ny][nx] !== word[i]) return false;
  }
  return true;
}

function place(word) {
  for (let t = 0; t < 200; t++) {
    const [dx, dy] = directions[Math.floor(Math.random() * directions.length)];
    const x = Math.floor(Math.random() * gridSize);
    const y = Math.floor(Math.random() * gridSize);
    if (fits(word, x, y, dx, dy)) {
      for (let i = 0; i < word.length; i++) {
        grid[y + dy * i][x + dx * i] = word[i];
      }
      return true;
    }
  }
  return false;
}

const insertedWords = [];
words.forEach(w => {
  const word = w.trim().toUpperCase();
  if (word.length <= gridSize && place(word)) insertedWords.push(word);
});

for (let y = 0; y < gridSize; y++) {
  for (let x = 0; x < gridSize; x++) {
    if (!grid[y][x]) {
      grid[y][x] = String.fromCharCode(65 + Math.floor(Math.random() * 26));
    }
  }
}

const gridEl = document.getElementById("grid");
gridEl.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
gridEl.innerHTML = "";

for (let y = 0; y < gridSize; y++) {
  for (let x = 0; x < gridSize; x++) {
    const div = document.createElement("div");
    div.className = "cell";
    div.textContent = grid[y][x];
    div.dataset.x = x;
    div.dataset.y = y;
    gridEl.appendChild(div);
  }
}

const wordListEl = document.getElementById("wordList");
insertedWords.forEach(word => {
  const span = document.createElement("span");
  span.textContent = word;
  span.dataset.word = word;
  wordListEl.appendChild(span);
});

const selected = [];
const found = new Set();
const winEl = document.getElementById("winMessage");

const clickSound = new Audio("https://nikashum93.github.io/wordsearch1/click.mp3");
const errorSound = new Audio("https://nikashum93.github.io/wordsearch1/error.mp3");
const winSound = new Audio("https://nikashum93.github.io/wordsearch1/win.mp3");

function sparkleAt(x, y) {
  const s = document.createElement("div");
  s.style.position = "absolute";
  s.style.left = x + "px";
  s.style.top = y + "px";
  s.style.width = "8px";
  s.style.height = "8px";
  s.style.background = "#fff";
  s.style.borderRadius = "50%";
  s.style.boxShadow = "0 0 6px white";
  s.style.pointerEvents = "none";
  document.body.appendChild(s);
  setTimeout(() => s.remove(), 300);
}

function playSound(snd) {
  snd.currentTime = 0;
  snd.play().catch(() => {});
}

function getWord() {
  return selected.map(c => c.textContent).join("");
}

function clearSel(error = false) {
  selected.forEach(c => {
    c.classList.remove("selected");
    if (error) {
      c.style.background = "rgba(255,0,0,0.4)";
      setTimeout(() => c.style.background = "", 300);
    }
  });
  selected.length = 0;
}

function checkWord() {
  const word = getWord();
  const reversed = word.split("").reverse().join("");
  const match = insertedWords.find(w => w === word || w === reversed);
  if (match && !found.has(match)) {
    selected.forEach(c => c.classList.add("found"));
    document.querySelector(`#wordList span[data-word="${match}"]`)?.classList.add("found");
    found.add(match);
    playSound(clickSound);
    if (found.size === insertedWords.length) {
      winSound.play();
      winEl.style.display = "block";
      document.querySelectorAll(".cell").forEach(c => c.classList.add("rainbow"));
    }
    selected.length = 0;
  } else {
    playSound(errorSound);
    clearSel(true);
  }
}

document.querySelectorAll(".cell").forEach(cell => {
  cell.addEventListener("click", e => {
    if (cell.classList.contains("found") || selected.includes(cell)) return;
    selected.push(cell);
    cell.classList.add("selected");

    if (${sparkles}) sparkleAt(e.clientX, e.clientY);

    if (selected.length > 1) {
      const dx = selected[1].dataset.x - selected[0].dataset.x;
      const dy = selected[1].dataset.y - selected[0].dataset.y;
      for (let i = 2; i < selected.length; i++) {
        const cx = selected[i].dataset.x - selected[i - 1].dataset.x;
        const cy = selected[i].dataset.y - selected[i - 1].dataset.y;
        if (cx != dx || cy != dy) {
          clearSel(true);
          return;
        }
      }
    }

    if (selected.length >= 2) checkWord();
  });
});
</script>
</body>
</html>
